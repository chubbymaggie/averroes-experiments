#! /usr/bin/env bash

set -e

base=$1
benchmark=$2
outputdir=${base}/callgraphs/${benchmark} 
  
echo "running ${benchmark}"

# 1. create output directory
mkdir -p ${outputdir}/
  
# 2. run spark
echo "  running spark"
./run-tool spark -vanilla ${base} ${benchmark} > ${outputdir}/spark.log
echo "  running spark-averroes"
./run-tool spark -averroes ${base} ${benchmark} > ${outputdir}/spark-averroes.log

# 2. run doop
echo "  running doop"
./run-tool doop -vanilla ${base} ${benchmark} > ${outputdir}/doop.log
echo "  running doop-averroes"
./run-tool doop -averroes ${base} ${benchmark} > ${outputdir}/doop-averroes.log

# 2. run wala
echo "  running wala"
./run-tool wala -vanilla ${base} ${benchmark} > ${outputdir}/wala.log
echo "  running wala-averroes"
./run-tool wala -averroes ${base} ${benchmark} > ${outputdir}/wala-averroes.log